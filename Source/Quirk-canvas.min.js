var quirk,ShapeType={EMPTY:0,CHALK:1,LINE:2,RECTANGLE:3,properties:{0:{name:"Empty",value:0},1:{name:"Chalk",value:1},2:{name:"Line",value:2},3:{name:"Rectangle",value:3}}},StateType={draw:1,text:2},color="#cc4499",eraser=!1;(function(){var a,b,c=164,d=122,f,g,h,j,k=4,l,m,p,q;String["prototype"]["format"]|| (String["prototype"]["format"]= function(){var v=arguments;return this["replace"](/{(\d+)}/g,function(w,z){return "undefined"==  typeof v[z]?w:v[z]})}),(Quirk= function Quirk(v){if(v&& "string"==  typeof v){h= document["getElementById"](v)}else {throw "Unknown identifier"}}),(Quirk["prototype"]= {init:function init(){(a= document["createElement"]("canvas")),(b= document["createElement"]("span")),a["setAttribute"]("width",h["width"]),a["setAttribute"]("height",h["height"]),a["setAttribute"]("id","tempCanvas"),a["setAttribute"]("border","2px"),(b["style"]["border"]= "2px solid #c9c9c9"),(b["style"]["width"]= c+ "px"),(b["style"]["height"]= d+ "px"),(b["style"]["position"]= "absolute"),(b["style"]["left"]= h["width"]- c- 10+ "px"),(b["style"]["top"]= h["height"]- d+ 70+ "px"),(h["innerHTML"]= ""),h["parentNode"]["appendChild"](a),a["parentNode"]["appendChild"](b),"undefined"!=  typeof G_vmlCanvasManager&& (a= G_vmlCanvasManager["initElement"](a)),(f= a["getContext"]("2d")),(g= h["getContext"]("2d")),f["fillRect"](0,0,l,m),a["addEventListener"]&& (a["addEventListener"]("mousedown",this["move"],!1),a["addEventListener"]("mousemove",this["move"],!1),a["addEventListener"]("mouseup",this["move"],!1),a["addEventListener"]("click",this["insertText"],!1)),(quirk= this),(this["state"]= StateType["draw"]),(this["shape"]= this["setShape"](ShapeType.CHALK)),Object["defineProperty"](this,"isEditable",{get:function get(){return "undefined"== this["state"]|| this["state"]!= StateType["draw"]?!1:!0}})},setShape:function setShape(v){switch((this["isEditable"]|| (this["state"]= StateType["draw"]),(eraser=  !1),v)){case ShapeType["CHALK"]:j=  new Quirk["shapes"]["chalk"]();break;case ShapeType["LINE"]:j=  new Quirk["shapes"]["line"]();break;case ShapeType["RECTANGLE"]:j=  new Quirk["shapes"]["rectangle"]();break;default:}},setWrite:function setWrite(){j= null},setColor:function setColor(v){color= v},setEraser:function setEraser(){(eraser=  !0),(j=  new Quirk["shapes"]["chalk"]())},move:function move(v){if((v["layerX"]|| 0== v["layerX"]?((x= v["layerX"]),(y= v["layerY"])):(v["offsetX"]|| 0== v["offsetX"])&& ((x= v["offsetX"]),(y= v["offsetY"])),(p= v["pageX"]),(q= v["pageY"]),(b["innerHTML"]= "<center><p style='color:blue; font-weight: bold;'>x: "+ p+ ", y: "+ q+ "</p></center>"),null!= j)){switch(((f["strokeStyle"]= !0== eraser?"#ffffff":color),(f["lineWidth"]= k),(f["lineCap"]= "round"),event["type"])){case "mousedown":j["mousedown"](x,y);break;case "mousemove":j["mousemove"](x,y);break;case "mouseup":j["mouseup"](x,y);break;default:}}},insertHTML:function insertHTML(v){if(v&& "string"==  typeof v){var w=v["split"](/\r?\n/);if(0== w["length"]){throw "Empty data"};var z="<svg xmlns=\"http://www.w3.org/2000/svg\" style=\"position:absolute; left:{0}px; top:{1}px\">"["format"](p,q)+ "<foreignObject width=\"100%\" height=\"100%\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"font-size:18px\">",B=z;for(i= 0;i< w["length"];i++){B+= w[i]};B+= "</div></foreignObject></svg>";var C=window["URL"]|| window["webkitURL"]|| window,D= new Image(),E= new Blob([B],{type:"image/svg+xml"}),F=C["createObjectURL"](E);(D["onload"]= function(){g["drawImage"](D,0,0),C["revokeObjectURL"](F)}),(D["src"]= F)}},setPlus:function setPlus(){k++},setMinus:function setMinus(){k--},setSize:function setSize(v,w,z,A){(v["style"]["position"]= "absolute"),(v["style"]["left"]= w+ "px"),(v["style"]["top"]= z+ "px"),(v["style"]["height"]= A)},insertText:function insertText(){var v=document["getElementById"]("editor"),w=document["getElementById"]("editorbar");if(null== j&& null== v){console["log"](j);var v=document["createElement"]("iframe");(v["id"]= "editor"),quirk["setSize"](v,p,q,"50px");var w=document["createElement"]("div");(w["id"]= "editorbar"),quirk["setSize"](w,p,q- 25,"25px"),(w["innerHTML"]= "<table><tr><td><button class='fa fa-bold' aria-hidden='true' data-command='bold' onClick=\"javascript:quirk.execCommand('bold');\"></button></td><td><button class='fa fa-italic' aria-hidden='true' data-command='italic' onClick=\"javascript:quirk.execCommand('italic');\"></button></td><td><button class='fa fa-underline' aria-hidden='true' data-command='underline' onClick=\"javascript:quirk.execCommand('underline');\"></button></td></tr></table>"),document["body"]["appendChild"](v),(v["style"]["border"]= "1px dotted"),(v["style"]["resize"]= "both"),v["parentNode"]["insertBefore"](w,v),w["setAttribute"]("display","inline");var z=v["contentWindow"]["document"],A=z["body"];"spellcheck" in  A&& (A["spellcheck"]=  !1),"contentEditable" in  A?(A["contentEditable"]=  !0):"designMode" in  z&& (z["designMode"]= "on"),v["addEventListener"]&& v["contentWindow"]["addEventListener"]("paste",quirk["onPaste"],!1)}else {null!= v&& (quirk["insertHTML"](v["contentWindow"]["document"]["body"]["innerHTML"]),v["parentNode"]["removeChild"](v),w["parentNode"]["removeChild"](w))}},onPaste:function onPaste(v){var w,z;v["stopPropagation"](),v["preventDefault"](),(w= v["clipboardData"]|| window["clipboardData"]),(z= w["getData"]("Text"));var A=prompt("Please enter data","");document["getElementById"]("editor")["contentWindow"]["document"]["body"]["innerHTML"]= A},execCommand:function execCommand(v){document["getElementById"]("editor")["contentWindow"]["document"]["execCommand"](v,!1,null)}});var s;(Quirk["Shape"]= function(v){this["type"]= v}),(Quirk["Shape"]["prototype"]= {mousedown:function mousedown(){this["active"]=  !0},mousemove:function mousemove(){!s|| (s!= ShapeType["RECTANGLE"]&& s!= ShapeType["LINE"]) || this["active"]},mouseup:function mouseup(){this["active"]&& (f["closePath"](),g["drawImage"](a,0,0),f["clearRect"](0,0,a["width"],a["height"]),(this["active"]=  !1))}}),(Quirk["shapes"]= {}),(Quirk["shapes"]["chalk"]= function(){Quirk["Shape"]["call"](this,ShapeType.CHALK)}),(Quirk["shapes"]["line"]= function(){Quirk["Shape"]["call"](this,ShapeType.LINE)}),(Quirk["shapes"]["rectangle"]= function(){Quirk["Shape"]["call"](this,ShapeType.RECTANGLE)}),(Quirk["shapes"]["chalk"]["prototype"]= Object["create"](Quirk["Shape"]["prototype"])),(Quirk["shapes"]["line"]["prototype"]= Object["create"](Quirk["Shape"]["prototype"])),(Quirk["shapes"]["rectangle"]["prototype"]= Object["create"](Quirk["Shape"]["prototype"])),(Quirk["shapes"]["chalk"]["prototype"]["mousedown"]= function(v,w){Quirk["Shape"]["prototype"]["mousedown"]["call"](this),f["beginPath"](),f["moveTo"](v,w)}),(Quirk["shapes"]["chalk"]["prototype"]["mousemove"]= function(v,w){Quirk["Shape"]["prototype"]["mousemove"]["call"](this),this["active"]&& (f["lineTo"](v,w),f["stroke"]())});var t,u;(Quirk["shapes"]["chalk"]["prototype"]["mouseup"]= function(){Quirk["Shape"]["prototype"]["mouseup"]["call"](this)}),(Quirk["shapes"]["line"]["prototype"]["mousedown"]= function(v,w){Quirk["Shape"]["prototype"]["mousedown"]["call"](this),(t= v),(u= w)}),(Quirk["shapes"]["line"]["prototype"]["mousemove"]= function(v,w){Quirk["Shape"]["prototype"]["mousemove"]["call"](this),this["active"]&& (f["clearRect"](0,0,a["width"],a["height"]),f["beginPath"](),f["moveTo"](t,u),f["lineTo"](v,w),f["stroke"](),f["closePath"]())}),(Quirk["shapes"]["line"]["prototype"]["mouseup"]= function(){Quirk["Shape"]["prototype"]["mouseup"]["call"](this)}),(Quirk["shapes"]["rectangle"]["prototype"]["mousedown"]= function(v,w){Quirk["Shape"]["prototype"]["mousedown"]["call"](this),(t= v),(u= w)}),(Quirk["shapes"]["rectangle"]["prototype"]["mousemove"]= function(v,w){if((Quirk["Shape"]["prototype"]["mousemove"]["call"](this),this["active"])){var z=Math["min"](v,t),A=Math["min"](w,u),B=Math["abs"](v- t),C=Math["abs"](w- u);if((f["clearRect"](0,0,a["width"],a["height"]),!B||  !C)){return};f["strokeRect"](z,A,B,C)}}),(Quirk["shapes"]["rectangle"]["prototype"]["mouseup"]= function(){Quirk["Shape"]["prototype"]["mouseup"]["call"](this)})})()
